{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport Modal from 'antd/lib/modal/Modal';\nimport { Button, message } from 'antd';\nimport Axios from 'axios';\nimport { useState, useEffect } from 'react';\nimport moment from 'moment';\n\nconst NotifCard = ({\n  profile,\n  notif,\n  all\n}) => {\n  const {\n    0: isFull,\n    1: setFulltext\n  } = useState(notif.Message.length < 150);\n  const {\n    0: Data,\n    1: setData\n  } = useState();\n  const {\n    0: Loading,\n    1: setLoading\n  } = useState(true);\n  const {\n    0: action,\n    1: setAction\n  } = useState(\"\");\n  const {\n    0: buttonLoading,\n    1: setbuttonLoad\n  } = useState(false);\n  const {\n    0: visible,\n    1: setvisible\n  } = useState(false); // Handle data before loading componenent\n\n  moment.locale('fr');\n  useEffect(() => {\n    Axios.get(\"http://localhost:9000/profiles/profile?userid=\" + notif.SenderId, {\n      withCredentials: true\n    }).then(result => {\n      setData(result.data.profile);\n      setLoading(false);\n    }).catch(err => console.log(err));\n    Axios.get(\"http://localhost:9000/profiles/viewedNot\", {\n      withCredentials: true\n    }).then(result => {}).catch(err => console.log(err));\n  }, []); // ----------------------------\n  // When accept the request handler \n\n  const HandleAccept = () => {\n    setbuttonLoad(true);\n    action === \"accepted\" ? notif.AcceptStatus = true : notif.AcceptStatus = false;\n    notif.AcceptStatus === false ? all.splice(all.indexOf(notif)) : '';\n    notif.AcceptStatus === false ? profile.booked[notif.day].splice(profile.booked[notif.day].indexOf(notif.horraire), 1) : '';\n    const body = {\n      Notification: all,\n      booked: profile.booked\n    };\n    Axios.post(\"http://localhost:9000/profiles/updatebook\", body, {\n      withCredentials: true\n    }).then(result => {\n      console.log(result);\n    }).catch(err => console.log(err));\n    const Data = {\n      Notification: {\n        Type: \"Response\",\n        Message: \"Request \" + action,\n        horraire: notif.horraire,\n        day: notif.day,\n        AcceptStatus: action === \"accepted\" ? true : false\n      }\n    };\n    Axios.post(\"http://localhost:9000/profiles/bookmeeting?userid=\" + notif.SenderId, Data, {\n      withCredentials: true\n    }).then(result => {\n      setbuttonLoad(false);\n      setvisible(false);\n      message.success(\"mise à jour effectuée avec succès\");\n    }).catch(err => console.log(err));\n  };\n\n  if (Loading) {\n    return null;\n  } else {\n    return __jsx(React.Fragment, null, notif.Type === \"Request\" && __jsx(\"div\", {\n      className: \"NotifCard\"\n    }, __jsx(\"p\", null, __jsx(\"strong\", {\n      style: {\n        color: \"#0C72BF\"\n      }\n    }, \"Ce client\"), \" \", \"souhaite r\\xE9server une r\\xE9union Le\", \" \", __jsx(\"strong\", {\n      style: {\n        color: \"#0C72BF\"\n      }\n    }, notif.day, \" \"), \"a\", \" \", __jsx(\"strong\", {\n      style: {\n        color: \"#0C72BF\"\n      }\n    }, notif.horraire)), __jsx(\"div\", {\n      className: \"Card_Head\"\n    }, __jsx(\"div\", {\n      className: \"ProfileImg\"\n    }, __jsx(\"img\", {\n      src: Data.Usrimg\n    })), __jsx(\"div\", {\n      className: \"ProfileInfo\"\n    }, __jsx(\"a\", {\n      href: \"/Profiles/\" + notif.SenderId,\n      className: \"profileLink\"\n    }, __jsx(\"h3\", null, Data.companyname === undefined || Data.companyname === \"\" ? Data.nom + \" \" + Data.prenom : Data.companyname)))), __jsx(\"div\", {\n      className: \"Card_Body\"\n    }, __jsx(\"h3\", null, \"Message\"), __jsx(\"p\", null, !isFull ? notif.Message.substr(0, 150) : notif.Message, !isFull ? __jsx(\"span\", {\n      className: \"more\",\n      onClick: () => setFulltext(true)\n    }, \"Voir plus\") : \"\")), __jsx(\"div\", {\n      className: \"Card_footer\"\n    }, notif.AcceptStatus === null && __jsx(React.Fragment, null, __jsx(\"button\", {\n      className: \"Accepter\",\n      onClick: () => {\n        setvisible(true), setAction('accepted');\n      }\n    }, \"Accepter\"), __jsx(\"button\", {\n      className: \"Refuser\",\n      onClick: () => {\n        setvisible(true), setAction('refused');\n      }\n    }, \"Refuser\")), notif.AcceptStatus === true && __jsx(React.Fragment, null, __jsx(\"label\", {\n      style: {\n        color: \"#02C39A\"\n      }\n    }, __jsx(\"i\", {\n      style: {\n        marginRight: '5px'\n      },\n      className: \"fa fa-check\",\n      \"aria-hidden\": \"true\"\n    }), \"Accept\\xE9\")), notif.AcceptStatus === false && __jsx(React.Fragment, null, __jsx(\"label\", {\n      style: {\n        color: \"#CF0004\"\n      }\n    }, __jsx(\"i\", {\n      className: \"fa fa-times\",\n      \"aria-hidden\": \"true\",\n      style: {\n        marginRight: '5px'\n      }\n    }), \"Refus\\xE9\"))), __jsx(\"span\", {\n      style: {\n        fontFamily: 'GlacialRegular',\n        color: '#006d77'\n      }\n    }, moment(notif.date).fromNow()), __jsx(Modal, {\n      visible: visible,\n      width: \"20vw\",\n      onCancel: () => setvisible(false),\n      footer: [__jsx(Button, {\n        disabled: false,\n        key: \"submit\",\n        type: \"primary\",\n        loading: buttonLoading,\n        style: {\n          borderRadius: \"10px\",\n          fontFamily: \"GlacialBold\"\n        },\n        onClick: HandleAccept\n      }, \"Je suis s\\xFBr !\")]\n    }, __jsx(\"h3\", null, \"\\xCAtes-vous s\\xFBr de vouloir \", action === \"accepted\" ? \"accepter\" : \"refuser\", \" cette demande?\"))), notif.Type === \"Response\" && notif.AcceptStatus && __jsx(\"div\", {\n      className: \"NotifCard\"\n    }, __jsx(\"div\", {\n      className: \"Card_Head\"\n    }, __jsx(\"div\", {\n      className: \"ProfileImg\"\n    }, __jsx(\"img\", {\n      src: Data.Usrimg\n    }))), __jsx(\"p\", {\n      style: {\n        color: \"#02C39A\"\n      }\n    }, __jsx(\"strong\", {\n      style: {\n        fontFamily: \"GlacialBold\"\n      }\n    }, __jsx(\"a\", {\n      href: \"/Profiles/\" + notif.SenderId,\n      className: \"profileLink\",\n      style: {\n        color: \"#02C39A\"\n      }\n    }, Data.companyname)), \" \", \"a accept\\xE9 votre demande\", \" \"), __jsx(\"div\", {\n      className: \"Card_Body\"\n    }, __jsx(\"p\", {\n      style: {\n        color: \"#2a2a2a\",\n        fontSize: \"15px\"\n      }\n    }, \"Votre rendez-vous est pr\\xE9vue\", \" \", __jsx(\"strong\", {\n      style: {\n        fontFamily: \"GlacialBold\"\n      }\n    }, notif.day), \" \", \"a\", \" \", __jsx(\"strong\", {\n      style: {\n        fontFamily: \"GlacialBold\"\n      }\n    }, notif.horraire))), __jsx(\"span\", {\n      style: {\n        fontFamily: 'GlacialRegular',\n        color: '#006d77'\n      }\n    }, moment(notif.date).fromNow())), notif.Type === \"Response\" && !notif.AcceptStatus && __jsx(\"div\", {\n      className: \"NotifCard\"\n    }, __jsx(\"div\", {\n      className: \"Card_Head\"\n    }, __jsx(\"div\", {\n      className: \"ProfileImg\"\n    }, __jsx(\"img\", {\n      src: Data.Usrimg\n    }))), __jsx(\"p\", {\n      style: {\n        color: \"#CF0004\"\n      }\n    }, __jsx(\"strong\", {\n      style: {\n        fontFamily: \"GlacialBold\"\n      }\n    }, __jsx(\"a\", {\n      href: \"/Profiles/\" + notif.SenderId,\n      className: \"profileLink\",\n      style: {\n        color: \"#CF0004\"\n      }\n    }, Data.companyname)), \" \", \"a refus\\xE9 votre demande\", \" \"), __jsx(\"div\", {\n      className: \"Card_Body\"\n    }, __jsx(\"p\", {\n      style: {\n        color: \"#2a2a2a\",\n        fontSize: \"15px\"\n      }\n    }, \"Cette entreprise ne peut pas vous rencontrer Le\", \" \", __jsx(\"strong\", {\n      style: {\n        fontFamily: \"GlacialBold\"\n      }\n    }, notif.day), \" \", \"a\", \" \", __jsx(\"strong\", {\n      style: {\n        fontFamily: \"GlacialBold\"\n      }\n    }, notif.horraire), \" essayez une autre date .\")), __jsx(\"span\", {\n      style: {\n        fontFamily: 'GlacialRegular',\n        color: '#006d77'\n      }\n    }, moment(notif.date).fromNow())));\n  }\n};\n\nexport default NotifCard;","map":null,"metadata":{},"sourceType":"module"}