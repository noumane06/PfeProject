{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Noumane agouzil\\\\Desktop\\\\Normane\\\\My projects\\\\PfeProject\\\\Front-End\\\\pages\\\\Profiles\\\\Components\\\\Components\\\\BookMeeting.jsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport Modal from 'antd/lib/modal/Modal';\nimport { useState } from 'react';\nimport moment from 'moment';\nimport { Button, notification } from 'antd';\nimport axios from 'axios';\n\nconst BusyComponent = (day, hour, setTitle, setvisible) => {\n  const DateDivider = (string, hour) => {\n    const date = new Date(string);\n    const dateNow = new Date(); // console.log(hour);\n\n    const SommeDate = date.getDay() + date.getDate() + date.getFullYear();\n    const SommeDateNow = dateNow.getDay() + dateNow.getDate() + dateNow.getFullYear() + dateNow.getHours();\n    return [SommeDate, SommeDateNow];\n  };\n\n  const res = DateDivider(day, hour); // console.log(res);\n\n  return __jsx(React.Fragment, null, res <= 0 ? __jsx(\"div\", {\n    className: \"Busy\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 20\n    }\n  }) : __jsx(\"div\", {\n    onClick: () => {\n      setTitle(hour + \" | \" + day);\n      setvisible(true);\n    },\n    className: \"Free\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 51\n    }\n  }));\n};\n\nconst Scheduler = (StartHour, endtHour, length) => {\n  const results = [];\n\n  for (let i = 0; i <= parseInt(length); i++) {\n    const string = StartHour.format('HH:mm') + \"-\" + StartHour.add(30, 'minutes').format('HH:mm'); // Break betweeen meetings\n\n    results.push(string);\n\n    if (Math.abs(moment.duration(StartHour.diff(endtHour)).asMinutes()) <= 30) {\n      break;\n    }\n\n    StartHour.add(15, 'minutes');\n  }\n\n  return results;\n};\n\nconst DatePicker = string => {\n  const day = new Date(string);\n  const Days = ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'];\n  const Months = ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Aout', 'Septembre', 'Octobre', 'Novembre', 'Decembre'];\n  const DisplayString = [Days[day.getDay()], day.getDate(), Months[day.getMonth() + 1]];\n  return DisplayString;\n};\n\nconst calendar = ({\n  profile\n}) => {\n  //Data from database \n  const Horraire = profile.horraire;\n  var Booked = profile.booked !== undefined ? profile.booked : {}; // Horraires ----------------------\n\n  const date = new Date();\n  const StartHour = moment(Horraire[0], \"HH:mm\");\n  const endtHour = moment(Horraire[1], \"HH:mm\");\n  const length = (endtHour.format(\"HH\") - StartHour.format(\"HH\")) * 60 / 45;\n  const results = Scheduler(StartHour, endtHour, length); // States -------------------\n\n  const {\n    0: BookedDisplay,\n    1: setDisplay\n  } = useState(Booked !== {} ? Booked : {\n    \"\": \"\"\n  });\n  const {\n    0: visible,\n    1: setvisible\n  } = useState(false);\n  const {\n    0: title,\n    1: setTitle\n  } = useState();\n  const {\n    0: message,\n    1: setMessage\n  } = useState(\"\");\n  const {\n    0: loading,\n    1: setloading\n  } = useState(false); // Days ---------------------------\n\n  const datePusher = new Date();\n  const dayResult = [moment(Date.now()).format('YYYY/MM/DD')];\n\n  for (let i = 0; i < 6; i++) {\n    datePusher.setDate(datePusher.getDate() + 1);\n    dayResult.push(moment(datePusher).format('YYYY/MM/DD'));\n  } // -------------------------------------\n  // Handlers ---------------------------------\n\n\n  const handleSave = async () => {\n    if (Booked[title.split(\" | \")[1]] !== undefined) {\n      Booked[title.split(\" | \")[1]].push(title.split(\" | \")[0]);\n      console.log(Booked);\n    } else {\n      const key = [title.split(\" | \")[1]];\n      const value = title.split(\" | \")[0];\n      console.log(Booked);\n      Booked === {\n        \"\": \"\"\n      } ? Booked = {\n        [key[0]]: [value]\n      } : Booked = _objectSpread(_objectSpread({}, Booked), {}, {\n        [key[0]]: [value]\n      });\n      console.log(Booked);\n    }\n\n    setloading(true);\n    const Data = {\n      booked: Booked,\n      Notification: {\n        Type: \"Request\",\n        Message: message,\n        horraire: title.split(\" | \")[0],\n        day: title.split(\" | \")[1]\n      }\n    };\n    axios.post('http://localhost:9000/profiles/bookmeeting?userid=' + profile._id, Data, {\n      withCredentials: true\n    }).then(data => {\n      console.log(data);\n      setDisplay(Booked);\n      notification['success']({\n        message: 'Votre demande a été envoyée avec succès',\n        description: 'Nous vous informerons lorsque nous aurons une réponse'\n      });\n      setTimeout(() => {\n        setloading(false);\n        setvisible(false);\n        window.location.reload();\n      }, 2000);\n    }).catch(err => console.log(err));\n  }; // -----------------------------------\n\n\n  return __jsx(\"table\", {\n    id: \"calendar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 9\n    }\n  }, __jsx(Modal, {\n    title: title,\n    visible: visible,\n    width: \"50vw\",\n    onCancel: () => setvisible(false),\n    bodyStyle: {\n      height: '100%'\n    },\n    footer: [__jsx(Button, {\n      disabled: false,\n      key: \"submit\",\n      type: \"primary\",\n      loading: loading,\n      style: {\n        borderRadius: '10px',\n        fontFamily: 'GlacialBold'\n      },\n      onClick: handleSave,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 26\n      }\n    }, \"Envoyer\")],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 13\n    }\n  }, __jsx(\"label\", {\n    style: {\n      color: '#2a2a2a',\n      fontFamily: 'GlacialBold',\n      fontSize: '16px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 17\n    }\n  }, \"Message\"), __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 117\n    }\n  }), __jsx(\"textarea\", {\n    className: \"textArea\",\n    placeholder: \"D\\xE9crivez votre objectif de la r\\xE9union\",\n    rows: \"4\",\n    value: message,\n    onChange: e => setMessage(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 17\n    }\n  }), __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 171\n    }\n  }), __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 176\n    }\n  })), __jsx(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }\n  }, __jsx(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 17\n    }\n  }, __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 21\n    }\n  }), dayResult.map(day => __jsx(\"th\", {\n    key: day + Date.now(),\n    style: parseInt(day.split('/')[2]) === date.getDate() ? {\n      color: '#1a73e8',\n      textAlign: \"center\"\n    } : {\n      textAlign: \"center\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 43\n    }\n  }, DatePicker(day)[0], \" \", __jsx(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 216\n    }\n  }), \" \", DatePicker(day)[1], \" \", DatePicker(day)[2], \" \")))), __jsx(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 13\n    }\n  }, results.map(hour => __jsx(\"tr\", {\n    key: hour + Date.now(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 21\n    }\n  }, __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 25\n    }\n  }, hour), dayResult.map(day => __jsx(\"td\", {\n    key: day + hour,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 25\n    }\n  }, BookedDisplay[day] !== undefined && (BookedDisplay[day].includes(hour) ? __jsx(\"div\", {\n    className: \"Booked\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 69\n    }\n  }, \"Booked\") : __jsx(BusyComponent, {\n    day: day,\n    hour: hour,\n    setTitle: setTitle,\n    setvisible: setvisible,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 108\n    }\n  })), console.log(hour.toString()), BookedDisplay[day] === undefined && __jsx(BusyComponent, {\n    day: day,\n    hour: hour,\n    setTitle: setTitle,\n    setvisible: setvisible,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 33\n    }\n  })))))));\n};\n\nexport default calendar;","map":{"version":3,"sources":["C:/Users/Noumane agouzil/Desktop/Normane/My projects/PfeProject/Front-End/pages/Profiles/Components/Components/BookMeeting.jsx"],"names":["Modal","useState","moment","Button","notification","axios","BusyComponent","day","hour","setTitle","setvisible","DateDivider","string","date","Date","dateNow","SommeDate","getDay","getDate","getFullYear","SommeDateNow","getHours","res","Scheduler","StartHour","endtHour","length","results","i","parseInt","format","add","push","Math","abs","duration","diff","asMinutes","DatePicker","Days","Months","DisplayString","getMonth","calendar","profile","Horraire","horraire","Booked","booked","undefined","BookedDisplay","setDisplay","visible","title","message","setMessage","loading","setloading","datePusher","dayResult","now","setDate","handleSave","split","console","log","key","value","Data","Notification","Type","Message","post","_id","withCredentials","then","data","description","setTimeout","window","location","reload","catch","err","height","borderRadius","fontFamily","color","fontSize","e","target","map","textAlign","includes","toString"],"mappings":"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","sourcesContent":["\r\nimport Modal from 'antd/lib/modal/Modal';\r\nimport {useState} from 'react';\r\nimport moment from 'moment';\r\nimport { Button, notification } from 'antd';\r\nimport axios from 'axios';\r\n\r\nconst BusyComponent = (day ,hour , setTitle , setvisible)=>{\r\n\r\n    const DateDivider = (string , hour)=>\r\n    {\r\n        const date = new Date(string );\r\n        const dateNow = new Date();\r\n        // console.log(hour);\r\n        const SommeDate = date.getDay()+date.getDate()+date.getFullYear();\r\n        const SommeDateNow = dateNow.getDay()+dateNow.getDate()+dateNow.getFullYear()+dateNow.getHours();\r\n        return [SommeDate,SommeDateNow ];\r\n    }\r\n    const res = DateDivider(day,hour);\r\n    // console.log(res);\r\n    return(\r\n        \r\n        <>\r\n        {res <= 0 ?<div className=\"Busy\"></div> : <div onClick={()=>{setTitle(hour+\" | \"+day); setvisible(true)}} className=\"Free\"></div>}\r\n        </>\r\n    )\r\n}\r\nconst Scheduler =  (StartHour , endtHour , length )=>{\r\n    const results = [];\r\n     for (let i = 0; i <= parseInt(length) ; i++) {\r\n        const string  =  StartHour.format('HH:mm')+\"-\"+StartHour.add(30,'minutes').format('HH:mm') ;\r\n\r\n        // Break betweeen meetings\r\n         results.push(string);\r\n        if (Math.abs(moment.duration(StartHour.diff(endtHour)).asMinutes()) <= 30 ) {\r\n            break ;\r\n        }\r\n        \r\n         StartHour.add(15,'minutes');\r\n    }\r\n    return(results);\r\n}\r\n\r\nconst DatePicker = (string) =>\r\n{\r\n    const day = new Date(string);\r\n    const Days = ['Dimanche','Lundi','Mardi','Mercredi','Jeudi','Vendredi','Samedi'];\r\n    const Months = ['Janvier','Février','Mars','Avril','Mai','Juin','Juillet','Aout','Septembre','Octobre','Novembre','Decembre'];\r\n    const DisplayString = [Days[day.getDay()],day.getDate(),Months[day.getMonth()+1]];\r\n\r\n    return DisplayString;\r\n}\r\n\r\n\r\nconst calendar = ({profile})=>{\r\n\r\n    //Data from database \r\n    \r\n    const Horraire = profile.horraire;\r\n    var Booked  = profile.booked !== undefined ? profile.booked :{};\r\n    // Horraires ----------------------\r\n    const date = new Date();\r\n    \r\n    const StartHour = moment(Horraire[0],\"HH:mm\");\r\n    const endtHour = moment(Horraire[1],\"HH:mm\");\r\n    const length = (endtHour.format(\"HH\")-StartHour.format(\"HH\"))*60/45;\r\n    const results = Scheduler(StartHour,endtHour,length);\r\n\r\n\r\n\r\n    // States -------------------\r\n    \r\n    const [BookedDisplay , setDisplay] = useState(Booked !== {} ? Booked : {\"\":\"\"});\r\n    const [visible,setvisible] = useState(false);\r\n    const [title , setTitle] = useState();\r\n    const [message , setMessage] = useState(\"\");\r\n    const [loading,setloading] = useState(false);\r\n    // Days ---------------------------\r\n\r\n    const datePusher = new Date();\r\n    const dayResult = [moment(Date.now()).format('YYYY/MM/DD')];\r\n    for (let i = 0 ; i < 6; i++) {\r\n        datePusher.setDate(datePusher.getDate()+1);\r\n        dayResult.push(moment(datePusher).format('YYYY/MM/DD'));\r\n    }\r\n\r\n    // -------------------------------------\r\n\r\n    // Handlers ---------------------------------\r\n\r\n    const handleSave = async  () =>{\r\n        if (Booked[title.split(\" | \")[1]] !== undefined) {\r\n            Booked[title.split(\" | \")[1]].push(title.split(\" | \")[0]) ;\r\n            console.log(Booked); \r\n        }else\r\n        {\r\n            const key = [title.split(\" | \")[1]];\r\n            const value = title.split(\" | \")[0] ; \r\n            console.log(Booked); \r\n            Booked === {\"\":\"\"} ? Booked = {[key[0]] : [value]} :Booked= {...Booked , [key[0]] : [value]};\r\n            console.log(Booked); \r\n        }\r\n        setloading(true);\r\n        const Data = {\r\n            booked : Booked ,\r\n            Notification : {\r\n                Type : \"Request\",\r\n                Message : message,\r\n                horraire : title.split(\" | \")[0],\r\n                day : title.split(\" | \")[1]\r\n            }\r\n        }\r\n        \r\n        axios.post('http://localhost:9000/profiles/bookmeeting?userid='+profile._id,Data,{withCredentials : true})\r\n        .then(data => \r\n            {\r\n                console.log(data) ;\r\n                setDisplay(Booked);\r\n                notification['success']({\r\n                    message: 'Votre demande a été envoyée avec succès',\r\n                    description:'Nous vous informerons lorsque nous aurons une réponse'\r\n                })\r\n                setTimeout(() => {\r\n                    setloading(false);\r\n                    setvisible(false);\r\n                    window.location.reload();\r\n                }, 2000);\r\n                \r\n            })\r\n        .catch(err => console.log(err))\r\n    }\r\n    // -----------------------------------\r\n    return(\r\n        <table id=\"calendar\">\r\n            <Modal title={title} visible={visible} width=\"50vw\" onCancel={()=>setvisible(false)} bodyStyle={{height : '100%'}} \r\n                footer={[<Button disabled={false} key=\"submit\" type=\"primary\" loading={loading}  style={{borderRadius :'10px', fontFamily :'GlacialBold'}} onClick={handleSave} >Envoyer</Button>]}>\r\n                {/* Presentation ------------------------------------------ */}\r\n                <label style={{color : '#2a2a2a' , fontFamily : 'GlacialBold' , fontSize : '16px'}} >Message</label><br/>\r\n                <textarea className=\"textArea\"  placeholder=\"Décrivez votre objectif de la réunion\" rows=\"4\" value={message} onChange={(e)=>setMessage(e.target.value)} /><br/><br/>\r\n            </Modal>\r\n            <thead>\r\n            \r\n                <tr>\r\n                    <th></th>\r\n                    {dayResult.map(day =>(<th key={day+Date.now()}  style={parseInt(day.split('/')[2]) === date.getDate() ? {color : '#1a73e8' , textAlign : \"center\"} : {textAlign : \"center\"}} >{DatePicker(day)[0]} <br/> {DatePicker(day)[1]} {DatePicker(day)[2]} </th>))}\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                {results.map(hour => (\r\n                    <tr key={hour+Date.now()}> \r\n                        <th>{hour}</th>\r\n                        {dayResult.map(day =>(\r\n                        <td key={day+hour} >\r\n                            {BookedDisplay[day] !== undefined &&(\r\n                                BookedDisplay[day].includes(hour) ? <div className=\"Booked\">Booked</div> : <BusyComponent day={day} hour={hour} setTitle={setTitle} setvisible={setvisible}/>\r\n                            )}\r\n                            {console.log(hour.toString())}\r\n                            {BookedDisplay[day] === undefined &&(\r\n                                <BusyComponent day={day} hour={hour} setTitle={setTitle} setvisible={setvisible}/>\r\n                            )}\r\n                        </td>))}\r\n                    </tr>\r\n                ))}\r\n            </tbody>\r\n            \r\n        </table>\r\n    )\r\n}\r\nexport default calendar ;"]},"metadata":{},"sourceType":"module"}