{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\Noumane agouzil\\\\Desktop\\\\Normane\\\\My projects\\\\PfeProject\\\\Front-End\\\\pages\\\\Profiles\\\\[_id].js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Head from '../../components/head';\nimport Header from '../../components/header';\nimport { useState, useEffect } from 'react';\nimport { Spin } from 'antd';\nimport PublicProfile from './Components/publicProfile';\n\nvar Profile = function Profile(_ref) {\n  _s();\n\n  var props = _ref.props,\n      AuthId = _ref.AuthId;\n\n  var _useState = useState(),\n      userid = _useState[0],\n      setData = _useState[1];\n\n  var _useState2 = useState(true),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  useEffect(function () {\n    if (props.data.profile !== undefined) {\n      setData(AuthId);\n      setLoading(false);\n    } else {\n      console.log(props.data.error);\n      var location = \"/Auth/Signin/?ref=tokenexpired&location=\" + window.location.href;\n      window.location.replace(location);\n    }\n\n    console.log(props, AuthId);\n  }, []);\n\n  if (loading) {\n    return __jsx(React.Fragment, null, __jsx(Head, {\n      title: \"Loading\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 27,\n        columnNumber: 17\n      }\n    }), __jsx(\"div\", {\n      style: {\n        position: 'fixed',\n        top: '50%',\n        left: '50%',\n        marginTop: '-50px',\n        marginLeft: '-50px'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 28,\n        columnNumber: 17\n      }\n    }, __jsx(Spin, {\n      size: \"large\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 29,\n        columnNumber: 21\n      }\n    })));\n  } else {\n    return __jsx(\"div\", {\n      className: \"body\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 35,\n        columnNumber: 13\n      }\n    }, __jsx(Header, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 21\n      }\n    }), props.data === undefined ? __jsx(Head, {\n      title: \"Loading\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 49\n      }\n    }) : '', __jsx(\"div\", {\n      style: {\n        marginTop: '8%'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 21\n      }\n    }, props.data !== undefined && __jsx(PublicProfile, {\n      profile: props.data.profile,\n      userid: userid,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 29\n      }\n    })));\n  }\n};\n\n_s(Profile, \"xPJEkg/h7ATkKCt8P2PiHM9QF0U=\");\n\n_c = Profile;\n\nProfile.getInitialProps = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(ctx) {\n    var cookie, statusCode, AuthId, _res, data, url, _res2;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            cookie = ctx.req.headers.cookie;\n            statusCode = '';\n            AuthId = '';\n            _context.next = 6;\n            return fetch('http://localhost:9000/profiles/myprofile', {\n              headers: {\n                cookie: cookie\n              }\n            });\n\n          case 6:\n            _res = _context.sent;\n            _context.next = 9;\n            return _res.json();\n\n          case 9:\n            data = _context.sent;\n            data.profile !== undefined ? AuthId = data.profile._id : \"\";\n\n            if (!(ctx.query._id !== 'Myprofile' && ctx.query._id !== AuthId && data.profile !== undefined)) {\n              _context.next = 20;\n              break;\n            }\n\n            url = \"http://localhost:9000/profiles/profile?userid=\" + ctx.query._id;\n            _context.next = 15;\n            return fetch(url, {\n              headers: {\n                cookie: cookie\n              }\n            });\n\n          case 15:\n            _res2 = _context.sent;\n            statusCode = _res2.status;\n            _context.next = 19;\n            return _res2.json();\n\n          case 19:\n            data = _context.sent;\n\n          case 20:\n            if (!(statusCode === 404)) {\n              _context.next = 22;\n              break;\n            }\n\n            throw 404;\n\n          case 22:\n            return _context.abrupt(\"return\", {\n              props: {\n                data: data\n              },\n              AuthId: AuthId\n            });\n\n          case 25:\n            _context.prev = 25;\n            _context.t0 = _context[\"catch\"](0);\n            res.statusCode = 404;\n            return _context.abrupt(\"return\", {\n              props: {}\n            });\n\n          case 29:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[0, 25]]);\n  }));\n\n  return function (_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nexport default Profile;\n\nvar _c;\n\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"sources":["C:/Users/Noumane agouzil/Desktop/Normane/My projects/PfeProject/Front-End/pages/Profiles/[_id].js"],"names":["Head","Header","useState","useEffect","Spin","PublicProfile","Profile","props","AuthId","userid","setData","loading","setLoading","data","profile","undefined","console","log","error","location","window","href","replace","position","top","left","marginTop","marginLeft","getInitialProps","ctx","cookie","req","headers","statusCode","fetch","res","json","_id","query","url","status"],"mappings":"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","sourcesContent":["import Head from '../../components/head';\r\nimport Header from '../../components/header'\r\nimport {useState , useEffect} from 'react';\r\nimport {Spin } from 'antd';\r\nimport PublicProfile from './Components/publicProfile';\r\n\r\nconst Profile = ({props , AuthId})=>{\r\n\r\n    const [userid,setData] = useState();\r\n    const [loading,setLoading] = useState(true);\r\n\r\n    useEffect(()=>{\r\n        if (props.data.profile !== undefined ) {\r\n            setData(AuthId);\r\n            setLoading(false);\r\n        }else{\r\n            console.log(props.data.error)\r\n            const location = \"/Auth/Signin/?ref=tokenexpired&location=\"+window.location.href;\r\n            window.location.replace(location);\r\n        }\r\n        console.log(props , AuthId);\r\n    },[])\r\n    if (loading ) {\r\n        \r\n        return(\r\n        <>\r\n                <Head title=\"Loading\"/>\r\n                <div style={{position : 'fixed',top : '50%',left:'50%',marginTop :'-50px',marginLeft:'-50px'}}>\r\n                    <Spin size=\"large\" />\r\n                </div>\r\n        </>\r\n        )\r\n    }else{\r\n        return(\r\n            <div className=\"body\">\r\n                    <Header/>\r\n                    {props.data === undefined ? <Head title=\"Loading\"/> :''}\r\n                    <div style={{marginTop :'8%'}}>\r\n                        { props.data !== undefined && (\r\n                            <PublicProfile profile={props.data.profile} userid={userid} />\r\n                        )}  \r\n                    </div>\r\n            </div>\r\n        )        \r\n    }\r\n    \r\n}\r\n\r\n\r\nProfile.getInitialProps = async (ctx) => {\r\n\r\n    // const cookie = ctx.req.headers.cookie ;\r\n    // var AuthId='';\r\n    // const res = await fetch('http://localhost:9000/profiles/myprofile',{\r\n    //     headers : {\r\n    //         cookie\r\n    //     }\r\n    // });\r\n    // var data = await res.json();\r\n    // data.profile !== undefined ? AuthId = data.profile._id  : \"\" ;\r\n\r\n    // if (ctx.query._id !== 'Myprofile' && ctx.query._id !== AuthId && data.profile !== undefined ) {\r\n    //     const url = \"http://localhost:9000/profiles/profile?userid=\"+ctx.query._id ;\r\n    //     const res = await fetch(url,{\r\n    //         headers : {\r\n    //             cookie\r\n    //         }\r\n    //     }); \r\n    //     data = await res.json();\r\n    // }\r\n    // return{\r\n    //     props : {\r\n    //         data\r\n    //     },\r\n    //     AuthId : AuthId\r\n    // }\r\n    try {\r\n        const cookie = ctx.req.headers.cookie ;\r\n        var statusCode = '';\r\n        var AuthId='';\r\n        const res = await fetch('http://localhost:9000/profiles/myprofile',{\r\n            headers : {\r\n                cookie\r\n            }\r\n        });\r\n        var data = await res.json();\r\n        data.profile !== undefined ? AuthId = data.profile._id  : \"\" ;\r\n\r\n        if (ctx.query._id !== 'Myprofile' && ctx.query._id !== AuthId && data.profile !== undefined ) {\r\n            const url = \"http://localhost:9000/profiles/profile?userid=\"+ctx.query._id ;\r\n            const res = await fetch(url,{\r\n                headers : {\r\n                    cookie\r\n                }\r\n            }); \r\n            statusCode = res.status;\r\n            data = await res.json();\r\n        }\r\n        if (statusCode === 404) {\r\n            throw 404 \r\n        }\r\n            return{\r\n            props : {\r\n                data\r\n            },\r\n            AuthId : AuthId\r\n        }\r\n    } catch (error) {\r\n        res.statusCode = 404;\r\n        return {\r\n               props : {}\r\n              };\r\n    }\r\n  }\r\n\r\nexport default Profile ;"]},"metadata":{},"sourceType":"module"}