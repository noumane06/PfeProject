{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Noumane agouzil\\\\Desktop\\\\Normane\\\\My projects\\\\PfeProject\\\\Front-End\\\\pages\\\\Profiles\\\\Components\\\\publicProfile.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\n// Dependencies ------------------------\nimport { useState, useEffect } from 'react';\nimport { Menu, Button, message } from 'antd';\nimport axios from 'axios';\nimport '../../../styles/ant-picker.scss';\nimport { storage } from './firebase'; // Components -------------------------\n\nimport Head from '../../../components/head';\nimport Icon from '@ant-design/icons';\nimport HomeSvg from './Svg/HomeSvg';\nimport AboutSvg from './Svg/AboutSvg';\nimport ClientSvg from './Svg/ClientSvg';\nimport '../Sass/fullProfile.scss';\nimport LikeButton from '../../../components/LikeButton';\nimport Geocode from \"react-geocode\";\nimport Modal from 'antd/lib/modal/Modal';\nimport EditBox from './EditBox';\nimport Calendar from './BookMeeting';\nimport NavAcceuil from './Components/NavAcceuil';\nimport NavPropos from './Components/NavPropos';\nimport ProgressBar from './Components/ProgressBar';\nimport ProfileHead from './Components/ProfileHead'; // -------------------------------------\n\nfunction isEmpty(obj) {\n  for (const [key, value] of Object.entries(obj)) {\n    if (value == \"\" || value == []) {\n      if (key !== \"booked\") {\n        return true;\n      }\n    }\n  }\n\n  return false;\n} // ----------------------------\n\n\nconst ProfileBody = ({\n  profile,\n  userid\n}) => {\n  // States ---------------------------------------\n  const name = profile.companyname === \"\" ? profile.nom + \" \" + profile.prenom : profile.companyname;\n  const {\n    0: imageLoading,\n    1: setloadimage\n  } = useState(false);\n  const {\n    0: current,\n    1: setCurrent\n  } = useState('Acceuil');\n  const {\n    0: checkbox,\n    1: setCheck\n  } = useState(profile.stars.includes(userid));\n  const {\n    0: bookmetting,\n    1: setbook\n  } = useState(false);\n  const {\n    0: data,\n    1: setData\n  } = useState(profile);\n  const {\n    0: location,\n    1: setLocation\n  } = useState({});\n  const {\n    0: filefirebase,\n    1: setfire\n  } = useState(null);\n  const {\n    0: percentage,\n    1: setPrecentage\n  } = useState(0);\n  const {\n    0: visible,\n    1: setvisible\n  } = useState(false);\n  const {\n    0: loading,\n    1: setloading\n  } = useState(false);\n  const {\n    0: DiplomeList,\n    1: setDiplomeList\n  } = useState(profile.diplome);\n  const date = new Date(); // Icons -----------------------------------------\n\n  const HomeIcon = props => __jsx(Icon, _extends({\n    component: HomeSvg\n  }, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 31\n    }\n  }));\n\n  const AboutIcon = props => __jsx(Icon, _extends({\n    component: AboutSvg\n  }, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 32\n    }\n  }));\n\n  const ClientsIcon = props => __jsx(Icon, _extends({\n    component: ClientSvg\n  }, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 34\n    }\n  }));\n\n  useEffect(() => {\n    const adr = profile.addresse + \" , \" + profile.city;\n    Geocode.setApiKey(\"AIzaSyChI3vJkg_P6JFZKVg9at3FtUZjxxI2lP8\");\n    Geocode.fromAddress(adr).then(response => {\n      const {\n        lat,\n        lng\n      } = response.results[0].geometry.location;\n      const loc = {\n        address: profile.addresse,\n        lat: lat,\n        lng: lng\n      };\n      setLocation(loc);\n    }, error => {\n      console.error(error);\n    });\n  }, []); // Firebase url upload function \n\n  const firebaseUrl = file => {\n    return new Promise((resolve, reject) => {\n      let currentImageName = \"firebase-image-\" + Date.now();\n      let uploadImage = storage.ref(`images/${currentImageName}`).put(file);\n      uploadImage.on('state_changed', snapshot => {\n        var per = Math.floor(snapshot.bytesTransferred / snapshot.totalBytes * 100);\n        setPrecentage(per);\n      }, error => {\n        reject(error);\n      }, () => {\n        storage.ref('images').child(currentImageName).getDownloadURL().then(url => {\n          const imageData = [url, currentImageName];\n          resolve(imageData);\n        });\n      });\n    });\n  }; // Handlers -------------------------------------\n\n\n  const handleLike = async () => {\n    var stars = profile.stars;\n\n    if (!checkbox) {\n      await stars.push(userid);\n    } else {\n      await stars.splice(stars.indexOf(userid), 1);\n    }\n\n    setCheck(!checkbox);\n    const Url = 'http://localhost:9000/profiles/like?userid=' + profile._id;\n    axios.post(Url, {\n      \"stars\": stars\n    }).then(res => console.log(res)).catch(err => console.log(err));\n  };\n\n  const handleClick = e => {\n    setCurrent(e.key);\n  };\n\n  const handleBack = () => {\n    window.location.assign(`/Search?companyname=${profile.companyname}&domaine=&city=&page=1`);\n  };\n\n  const handleEdit = () => {\n    setvisible(true);\n  };\n\n  const handleSave = async () => {\n    setData(_objectSpread(_objectSpread({}, data), {}, {\n      diplome: DiplomeList\n    }));\n\n    if (isEmpty(data)) {\n      message.error(\"Un ou plusieurs champs sont vides\");\n    } else {\n      setloading(true);\n\n      if (filefirebase !== null) {\n        setloadimage(true);\n        const imgData = await firebaseUrl(filefirebase);\n        setData(data.Usrimg = imgData[0]);\n      }\n\n      const url = \"http://localhost:9000/profiles/update?userid=\" + userid;\n      axios.post(url, data).then(response => {\n        if (response.status === 200) {\n          setloading(false);\n          setvisible(false);\n          message.success(\"Mise à jour réussie\");\n          setTimeout(() => {\n            window.location.reload();\n          }, 1000);\n        } else {\n          message.error(\"Une erreur s'est produite, veuillez réessayer plus tard\");\n        }\n      }).catch(err => {\n        message.error(\"Une erreur s'est produite, veuillez réessayer plus tard\");\n        console.log(err);\n      });\n    }\n  }; // ----------------------- Returner ----------------------------------------\n\n\n  return __jsx(\"div\", {\n    className: \"Profile\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 9\n    }\n  }, __jsx(Head, {\n    title: name + \" | 6Solutions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 13\n    }\n  }), __jsx(\"div\", {\n    className: \"ButtonContainer\",\n    onClick: handleBack,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }\n  }, __jsx(\"i\", {\n    className: \"fa fa-arrow-left icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 17\n    }\n  }), __jsx(\"span\", {\n    className: \"backButton\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 17\n    }\n  }, \"Retour\")), __jsx(ProfileHead, {\n    profile: profile,\n    handleEdit: handleEdit,\n    setbook: setbook,\n    userid: userid,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 13\n    }\n  }), __jsx(\"div\", {\n    className: \"ProfileBody\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 13\n    }\n  }, __jsx(Modal, {\n    title: \"Cliquez sur une case pour r\\xE9server une r\\xE9union\",\n    visible: bookmetting,\n    width: \"90%\",\n    bodyStyle: {\n      height: '50vh',\n      overflowY: 'scroll'\n    },\n    onCancel: () => setbook(false),\n    footer: null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 17\n    }\n  }, __jsx(Calendar, {\n    profile: profile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 209\n    }\n  })), __jsx(Modal, {\n    title: \"Editez votre profile\",\n    visible: visible,\n    width: \"50vw\",\n    bodyStyle: {\n      height: '50vh',\n      overflowY: 'scroll'\n    },\n    onCancel: () => setvisible(false),\n    footer: [__jsx(Button, {\n      disabled: false,\n      key: \"submit\",\n      type: \"primary\",\n      loading: loading,\n      style: {\n        borderRadius: '10px',\n        fontFamily: 'GlacialBold'\n      },\n      onClick: handleSave,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 29\n      }\n    }, \"Submit\")],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 17\n    }\n  }, !imageLoading && __jsx(EditBox, {\n    data: data,\n    setData: setData,\n    setDiplomeList: setDiplomeList,\n    DiplomeList: DiplomeList,\n    setfire: setfire,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 35\n    }\n  }), imageLoading && __jsx(ProgressBar, {\n    percentage: percentage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 21\n    }\n  })), __jsx(Menu, {\n    onClick: handleClick,\n    selectedKeys: current,\n    mode: \"horizontal\",\n    style: {\n      marginTop: '3%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 17\n    }\n  }, __jsx(Menu.Item, {\n    key: \"Acceuil\",\n    icon: __jsx(HomeIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 52\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 21\n    }\n  }, \"Acceuil\"), __jsx(Menu.Item, {\n    key: \"propos\",\n    icon: __jsx(AboutIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 51\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 21\n    }\n  }, \"A propos\"), __jsx(Menu.Item, {\n    key: \"clients\",\n    icon: __jsx(ClientsIcon, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 52\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 21\n    }\n  }, \"Clients\")), __jsx(\"div\", {\n    className: \"MenuContent\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 17\n    }\n  }, current === \"Acceuil\" && __jsx(React.Fragment, null, __jsx(NavAcceuil, {\n    date: date,\n    profile: profile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 29\n    }\n  })), current === \"propos\" && __jsx(React.Fragment, null, __jsx(NavPropos, {\n    profile: profile,\n    location: location,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 29\n    }\n  }))), __jsx(\"div\", {\n    className: \"MenuFooter\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 17\n    }\n  }, userid !== profile._id && __jsx(\"div\", {\n    className: \"like\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 25\n    }\n  }, __jsx(LikeButton, {\n    checkbox: checkbox,\n    handleLike: handleLike,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 25\n    }\n  }), __jsx(\"span\", {\n    className: checkbox ? \"active\" : \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 83\n    }\n  }, \"J'aime\")), __jsx(\"div\", {\n    className: \"share\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 21\n    }\n  }, __jsx(\"i\", {\n    className: \"fa fa-share-alt\",\n    \"aria-hidden\": \"true\",\n    style: {\n      marginRight: '5px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 21\n    }\n  }), \"Partager\"))));\n};\n\nexport default ProfileBody;","map":{"version":3,"sources":["C:/Users/Noumane agouzil/Desktop/Normane/My projects/PfeProject/Front-End/pages/Profiles/Components/publicProfile.js"],"names":["useState","useEffect","Menu","Button","message","axios","storage","Head","Icon","HomeSvg","AboutSvg","ClientSvg","LikeButton","Geocode","Modal","EditBox","Calendar","NavAcceuil","NavPropos","ProgressBar","ProfileHead","isEmpty","obj","key","value","Object","entries","ProfileBody","profile","userid","name","companyname","nom","prenom","imageLoading","setloadimage","current","setCurrent","checkbox","setCheck","stars","includes","bookmetting","setbook","data","setData","location","setLocation","filefirebase","setfire","percentage","setPrecentage","visible","setvisible","loading","setloading","DiplomeList","setDiplomeList","diplome","date","Date","HomeIcon","props","AboutIcon","ClientsIcon","adr","addresse","city","setApiKey","fromAddress","then","response","lat","lng","results","geometry","loc","address","error","console","firebaseUrl","file","Promise","resolve","reject","currentImageName","now","uploadImage","ref","put","on","snapshot","per","Math","floor","bytesTransferred","totalBytes","child","getDownloadURL","url","imageData","handleLike","push","splice","indexOf","Url","_id","post","res","log","catch","err","handleClick","e","handleBack","window","assign","handleEdit","handleSave","imgData","Usrimg","status","success","setTimeout","reload","height","overflowY","borderRadius","fontFamily","marginTop","marginRight"],"mappings":"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","sourcesContent":["// Dependencies ------------------------\r\n\r\nimport {useState , useEffect} from 'react';\r\nimport { Menu, Button, message } from 'antd' ;\r\nimport axios from 'axios';\r\nimport '../../../styles/ant-picker.scss';\r\nimport { storage } from './firebase'; \r\n\r\n// Components -------------------------\r\nimport Head from '../../../components/head';\r\nimport Icon from '@ant-design/icons';\r\nimport HomeSvg from './Svg/HomeSvg';\r\nimport AboutSvg from './Svg/AboutSvg';\r\nimport ClientSvg from './Svg/ClientSvg';\r\nimport '../Sass/fullProfile.scss';\r\nimport LikeButton from '../../../components/LikeButton';\r\nimport Geocode from \"react-geocode\";\r\nimport Modal from 'antd/lib/modal/Modal';\r\nimport EditBox from './EditBox';\r\nimport Calendar from './BookMeeting';\r\nimport NavAcceuil from './Components/NavAcceuil';\r\nimport NavPropos from './Components/NavPropos';\r\nimport ProgressBar from './Components/ProgressBar';\r\nimport ProfileHead from './Components/ProfileHead';\r\n// -------------------------------------\r\nfunction isEmpty(obj) {\r\n    for (const [key, value] of Object.entries(obj)) {\r\n        if (value == \"\" || value == []) {\r\n            if (key !== \"booked\") {\r\n                 return true ;\r\n            }\r\n        }\r\n      }\r\n    return false ;\r\n}\r\n\r\n// ----------------------------\r\nconst ProfileBody = ({profile , userid})=>{\r\n    // States ---------------------------------------\r\n    const name = profile.companyname === \"\" ? profile.nom+\" \"+profile.prenom : profile.companyname ;\r\n    const [imageLoading , setloadimage] = useState(false);\r\n    const [current , setCurrent] = useState('Acceuil');\r\n    const [checkbox,setCheck] = useState(profile.stars.includes(userid));\r\n    const [bookmetting,setbook] = useState(false);\r\n    const [data , setData] = useState(profile);\r\n    const [location , setLocation] = useState({});\r\n    const [filefirebase,setfire] = useState(null);\r\n    const [percentage , setPrecentage]= useState(0);\r\n    const [visible,setvisible] = useState(false);\r\n    const [loading,setloading] = useState(false);\r\n    const [DiplomeList , setDiplomeList] = useState(profile.diplome);\r\n\r\n    const date = new Date();\r\n\r\n    // Icons -----------------------------------------\r\n    const HomeIcon = props => <Icon component={HomeSvg} {...props} />;\r\n    const AboutIcon = props => <Icon component={AboutSvg} {...props} />;\r\n    const ClientsIcon = props => <Icon component={ClientSvg} {...props} />;\r\n    useEffect(()=>{\r\n        \r\n        const adr = profile.addresse + \" , \"+ profile.city ;\r\n        Geocode.setApiKey(\"AIzaSyChI3vJkg_P6JFZKVg9at3FtUZjxxI2lP8\");\r\n        Geocode.fromAddress(adr).then(\r\n            response => {\r\n              const { lat, lng } = response.results[0].geometry.location;\r\n              const loc = {address: profile.addresse,\r\n                            lat: lat,\r\n                            lng: lng\r\n              }\r\n              setLocation(loc);\r\n            },\r\n            error => {\r\n              console.error(error);\r\n            }\r\n          );\r\n    },[])\r\n    // Firebase url upload function \r\n    const firebaseUrl = (file) =>{\r\n        return new Promise((resolve,reject)=>{\r\n            let currentImageName = \"firebase-image-\" + Date.now();\r\n            let uploadImage = storage.ref(`images/${currentImageName}`).put(file);\r\n\r\n            uploadImage.on('state_changed',\r\n                (snapshot) => {\r\n                    var per = Math.floor((snapshot.bytesTransferred / snapshot.totalBytes) * 100)\r\n                    setPrecentage(per);\r\n                },\r\n                (error) => {\r\n                    reject(error);\r\n                },\r\n                () => {\r\n                    storage.ref('images').child(currentImageName).getDownloadURL().then(url => {\r\n                        const imageData = [url, currentImageName]\r\n                        resolve(imageData);\r\n                    })\r\n                })\r\n        })\r\n    }\r\n    // Handlers -------------------------------------\r\n    \r\n    const handleLike = async ()=>{\r\n        var stars = profile.stars ;\r\n        if (!checkbox) {\r\n           await stars.push(userid);\r\n        }else\r\n        {\r\n           await stars.splice(stars.indexOf(userid),1);\r\n        }\r\n        setCheck(!checkbox);\r\n        const Url = 'http://localhost:9000/profiles/like?userid='+profile._id;\r\n        axios.post(Url,{\"stars\":stars})\r\n        .then(res=>console.log(res))\r\n        .catch(err => console.log(err));\r\n    }\r\n\r\n    const handleClick = e =>{\r\n        setCurrent(e.key);\r\n    }\r\n    const handleBack = ()=>{\r\n        window.location.assign(`/Search?companyname=${profile.companyname}&domaine=&city=&page=1`);\r\n    }\r\n    const handleEdit = ()=>{\r\n        setvisible(true);\r\n    }\r\n\r\n    const handleSave = async () =>{\r\n            setData({...data , diplome : DiplomeList});\r\n            if (isEmpty(data)) {\r\n                message.error(\"Un ou plusieurs champs sont vides\")\r\n            }else{\r\n                setloading(true);\r\n                if (filefirebase !== null) {\r\n                    setloadimage(true);\r\n                    const imgData = await firebaseUrl(filefirebase);\r\n                    setData(data.Usrimg = imgData[0]);\r\n                }\r\n                const url = \"http://localhost:9000/profiles/update?userid=\" + userid ;\r\n                axios.post(url, data)\r\n                .then(response => {\r\n                if (response.status === 200) {\r\n                    setloading(false);\r\n                    setvisible(false);\r\n                    message.success(\"Mise à jour réussie\");\r\n                    setTimeout(() => {\r\n                        window.location.reload();\r\n                    }, 1000);\r\n                } else {\r\n                    message.error(\"Une erreur s'est produite, veuillez réessayer plus tard\");\r\n                }\r\n                })\r\n                .catch(err => {\r\n                    message.error(\"Une erreur s'est produite, veuillez réessayer plus tard\");\r\n                    console.log(err);\r\n                }); \r\n            }\r\n    }\r\n\r\n\r\n    // ----------------------- Returner ----------------------------------------\r\n    return(\r\n        <div className=\"Profile\">\r\n            <Head title={name+\" | 6Solutions\"}/>\r\n            <div className=\"ButtonContainer\" onClick={handleBack}>\r\n                <i className=\"fa fa-arrow-left icon\"></i>\r\n                <span className=\"backButton\">Retour</span>\r\n            </div>\r\n            <ProfileHead profile={profile} handleEdit={handleEdit} setbook={setbook} userid={userid} />\r\n            <div className=\"ProfileBody\">\r\n                <Modal title=\"Cliquez sur une case pour réserver une réunion\" visible={bookmetting} width=\"90%\" bodyStyle={{height: '50vh' , overflowY : 'scroll'}} onCancel={()=>setbook(false)} footer={null}><Calendar profile={profile}/></Modal>\r\n                <Modal title=\"Editez votre profile\" visible={visible} width=\"50vw\" bodyStyle={{height: '50vh', overflowY : 'scroll'}} onCancel={()=>setvisible(false)} footer={[\r\n                            <Button disabled={false} key=\"submit\" type=\"primary\" loading={loading} style={{borderRadius :'10px', fontFamily :'GlacialBold'}}  onClick={handleSave}>\r\n                                Submit\r\n                            </Button>\r\n                            ]}\r\n                >\r\n                {!imageLoading &&(<EditBox data={data} setData={setData} setDiplomeList={setDiplomeList} DiplomeList={DiplomeList} setfire={setfire}/>)}\r\n                {imageLoading &&(\r\n                    <ProgressBar percentage={percentage}/>\r\n                 )}\r\n                </Modal>\r\n\r\n                {/* Nav menu ------------------------------------ */}\r\n                <Menu onClick={handleClick} selectedKeys={current} mode=\"horizontal\" style={{marginTop :'3%'}}>\r\n                    <Menu.Item key=\"Acceuil\" icon={<HomeIcon />} >\r\n                        Acceuil\r\n                    </Menu.Item>\r\n                    <Menu.Item key=\"propos\" icon={<AboutIcon />}>\r\n                        A propos\r\n                    </Menu.Item>\r\n                    <Menu.Item key=\"clients\" icon={<ClientsIcon />}>\r\n                        Clients\r\n                    </Menu.Item>\r\n                </Menu>\r\n                <div className=\"MenuContent\">\r\n                    {current === \"Acceuil\" &&(\r\n                        <>\r\n                            <NavAcceuil date={date} profile={profile}/>\r\n                        </>\r\n                    )}\r\n                    {current === \"propos\" &&(\r\n                        <>\r\n                            <NavPropos profile={profile} location={location} />\r\n                        </>\r\n                    )}\r\n                </div>\r\n                <div className=\"MenuFooter\">\r\n                    {userid !== profile._id &&(\r\n                        <div className=\"like\">\r\n                        <LikeButton checkbox={checkbox} handleLike={handleLike} /><span className={checkbox ? \"active\" : \"\"}>J'aime</span>\r\n                        </div>\r\n                    )}\r\n                    \r\n                    <div className=\"share\">\r\n                    <i className=\"fa fa-share-alt\" aria-hidden=\"true\" style={{marginRight :'5px'}}></i>Partager\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\nexport default ProfileBody ;"]},"metadata":{},"sourceType":"module"}