{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport Header from '../../components/header';\nimport Head from '../../components/head';\nimport Footer from '../../components/footer';\nimport './scss/tem.scss';\nimport TemCard from '../../components/Temoignages_Components/TemCard';\nimport { useEffect, useState } from 'react';\nimport { Skeleton, Modal, Button, notification } from 'antd';\nimport Axios from 'axios';\n\nvar Temoignages = function Temoignages(props) {\n  var _useState = useState(),\n      Data = _useState[0],\n      setData = _useState[1];\n\n  var _useState2 = useState(true),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = useState(null),\n      id = _useState3[0],\n      setUserID = _useState3[1];\n\n  var _useState4 = useState(false),\n      temoign = _useState4[0],\n      setTemoign = _useState4[1];\n\n  var _useState5 = useState(false),\n      buttonLoading = _useState5[0],\n      setbuttonLoading = _useState5[1];\n\n  var _useState6 = useState(false),\n      linkErr = _useState6[0],\n      setLinkErr = _useState6[1];\n\n  var _useState7 = useState(''),\n      link = _useState7[0],\n      setLink = _useState7[1];\n\n  useEffect(function () {\n    console.log(props);\n    setData(props.data.data);\n    setLoading(false);\n  }, []);\n\n  function validVideoId(id) {\n    var img = new Image();\n    img.src = \"http://img.youtube.com/vi/\" + id + \"/mqdefault.jpg\";\n\n    img.onload = function () {\n      checkThumbnail(this.width);\n    };\n  }\n\n  function checkThumbnail(width) {\n    //HACK a mq thumbnail has width of 320.\n    //if the video does not exist(therefore thumbnail don't exist), a default thumbnail of 120 width is returned.\n    console.log(width);\n\n    if (width === 120) {\n      setLinkErr(true);\n      setbuttonLoading(false);\n    } else {\n      Axios.post(\"http://15.237.56.214:9000/temoin/\", {\n        link: link\n      }, {\n        withCredentials: true\n      }).then(function (res) {\n        notification['success']({\n          message: 'Succès',\n          description: 'Votre Témoignage a été ajouté avec succès '\n        });\n        setTimeout(function () {\n          setbuttonLoading(false);\n          setTemoign(false);\n          window.location.reload();\n        }, 2000);\n      })[\"catch\"](function (err) {\n        console.log(err);\n        notification['error']({\n          message: \"Une erreur s'est produite\",\n          description: 'Veuillez réessayer plus tard'\n        });\n        setTimeout(function () {\n          setbuttonLoading(false);\n          setTemoign(false);\n          window.location.reload();\n        }, 2000);\n      });\n    }\n  }\n\n  var handleClick = function handleClick() {\n    setbuttonLoading(true);\n    var check = link.split(\"v=\");\n\n    if (check[0] == \"https://www.youtube.com/watch?\" || check[0] == \"www.youtube.com/watch?\" || check[0] == \"youtube.com/watch?\") {\n      validVideoId(check[1]);\n    } else {\n      setLinkErr(true);\n      setbuttonLoading(false);\n    }\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"body\"\n  }, __jsx(\"div\", {\n    className: \"ContentInside\"\n  }, __jsx(Modal, {\n    title: \"T\\xE9moignage vid\\xE9o\",\n    visible: temoign,\n    width: \"60%\",\n    onCancel: function onCancel() {\n      return setTemoign(false);\n    },\n    footer: [__jsx(Button, {\n      disabled: false,\n      key: \"submit\",\n      type: \"primary\",\n      loading: buttonLoading,\n      style: {\n        borderRadius: '10px',\n        fontFamily: 'GlacialBold'\n      },\n      onClick: handleClick\n    }, \"Termin\\xE9 !\")]\n  }, __jsx(\"label\", {\n    style: {\n      color: '#318CE7',\n      fontFamily: 'GlacialBold',\n      fontSize: '16px'\n    }\n  }, \"Ajoutez votre lien Youtube :\"), __jsx(\"br\", null), __jsx(\"input\", {\n    className: linkErr ? \"input error\" : \"input\",\n    type: \"text\",\n    placeholder: \"Ex : https://www.youtube.com/watch?v=5qap5aO4i9A \",\n    value: link,\n    onChange: function onChange(e) {\n      setLink(e.target.value);\n      setLinkErr(false);\n    }\n  }), __jsx(\"br\", null), __jsx(\"label\", {\n    className: linkErr ? \"errMsg\" : \"hidden\"\n  }, \"Ce lien n'est pas valide, veuillez fournir un lien valide\"), __jsx(\"br\", null)), __jsx(Head, {\n    title: \"T\\xE9moignages | 6 solutions\"\n  }), __jsx(Header, {\n    active: \"temoignages\",\n    setUserID: setUserID\n  }), __jsx(\"div\", {\n    className: \"proposBody\"\n  }, __jsx(\"h1\", {\n    className: \"title\"\n  }, \"T\\xE9moignages\"), __jsx(\"div\", {\n    style: {\n      display: \"flex\",\n      justifyContent: \"space-between\",\n      alignItems: \"baseline\"\n    }\n  }, __jsx(\"div\", {\n    className: \"tems\"\n  }), id !== null && __jsx(\"div\", {\n    className: \"AddTem\"\n  }, __jsx(\"input\", {\n    className: \"TemButton\",\n    type: \"button\",\n    value: \"Ajouter un t\\xE9moignage\",\n    onClick: function onClick() {\n      return setTemoign(true);\n    }\n  }))), __jsx(Skeleton, {\n    loading: loading,\n    active: true,\n    avatar: true,\n    round: true,\n    className: \"sk\"\n  }, Data !== undefined && __jsx(\"div\", {\n    className: \"TemCards\"\n  }, Data.map(function (temData) {\n    return __jsx(TemCard, {\n      key: temData.temid,\n      props: temData\n    });\n  })))))), __jsx(Footer, null));\n};\n\nexport var __N_SSP = true;\nexport default Temoignages;","map":null,"metadata":{},"sourceType":"module"}