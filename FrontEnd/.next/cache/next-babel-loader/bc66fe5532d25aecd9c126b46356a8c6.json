{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport Link from 'next/link';\nimport axios from 'axios';\nimport { useEffect, useState } from 'react';\nimport { message } from 'antd';\n\nconst FormComponent = props => {\n  var data = {\n    // type must be either 'Société' or 'Client' , if you chnage the values be sure to change it in backend too\n    email: \"\",\n    password: \"\"\n  };\n  var {\n    0: userData,\n    1: setData\n  } = useState(data);\n  var {\n    0: emailErr,\n    1: setErrEm\n  } = useState(false);\n  var {\n    0: passwordErr,\n    1: setErrPass\n  } = useState(false);\n  const {\n    0: location,\n    1: setLocation\n  } = useState(\"/\");\n  const {\n    0: Loggedin,\n    1: setLog\n  } = useState(false);\n  useEffect(() => {\n    if (props.query.ref !== undefined) {\n      if (props.query.ref === \"tokenexpired\") {\n        message.warning('veuillez d abord vous connecter');\n      }\n    }\n\n    if (props.query.location !== undefined) {\n      setLocation(props.query.location);\n    }\n\n    axios.get('http://15.237.56.214:9000/profiles/myprofile', {\n      withCredentials: true\n    }).then(res => {\n      setLog(true);\n      setTimeout(() => {\n        window.location.replace(\"/\");\n      }, 5000);\n    }).catch(err => {});\n  }, []);\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    axios.post(\"http://15.237.56.214:9000/signin/\", userData, {\n      withCredentials: true\n    }).then(response => {\n      if (response.status === 200) {\n        window.location.replace(location);\n      } else {\n        setErrEm(true);\n        setErrPass(true);\n      }\n    }).catch(err => {\n      console.log(err);\n      setErrEm(true);\n      setErrPass(true);\n    });\n  };\n\n  const handleChange = event => {\n    const name = event.target.name;\n    const value = event.target.value;\n    setData(_objectSpread(_objectSpread({}, userData), {}, {\n      [name]: value\n    }));\n\n    if (name === \"email\") {\n      setErrEm(false);\n    }\n\n    if (name === \"password\") {\n      setErrPass(false);\n    }\n  };\n\n  return __jsx(\"div\", {\n    className: \"FormContainer\"\n  }, Loggedin && __jsx(\"div\", {\n    className: \"part 1\"\n  }, __jsx(\"h2\", null, \"Nous saluons le retour!\"), __jsx(\"p\", null, \"Vous \\xEAtes d\\xE9j\\xE0 connect\\xE9 et serez bient\\xF4t redirig\\xE9 vers page d'accueil.\"), __jsx(\"div\", {\n    className: \"FormFooter\"\n  }, \"Si vous n'\\xEAtes pas redirig\\xE9 automatiquement suivez\", __jsx(Link, {\n    href: \"/\"\n  }, __jsx(\"a\", null, \"ce lien\")))), !Loggedin && __jsx(React.Fragment, null, __jsx(\"h1\", null, \"Connectez-vous\"), __jsx(\"form\", {\n    onSubmit: handleSubmit\n  }, __jsx(\"label\", null, \"Email\"), __jsx(\"br\", null), __jsx(\"input\", {\n    className: emailErr ? \"input error\" : \"input\",\n    style: {\n      width: '80%'\n    },\n    type: \"email\",\n    name: \"email\",\n    onChange: handleChange,\n    value: userData.email,\n    required: true\n  }), __jsx(\"br\", null), __jsx(\"label\", {\n    className: emailErr ? \"errMsg\" : \"hidden\"\n  }, \"email invalide\"), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(\"label\", null, \"Mode de passe\"), __jsx(\"br\", null), __jsx(\"input\", {\n    className: passwordErr ? \"input error\" : \"input\",\n    style: {\n      width: '80%'\n    },\n    type: \"password\",\n    name: \"password\",\n    onChange: handleChange,\n    value: userData.password,\n    required: true\n  }), __jsx(\"br\", null), __jsx(\"label\", {\n    className: passwordErr ? \"errMsg\" : \"hidden\"\n  }, \"mot de passe incorrect\"), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(\"input\", {\n    className: \"SignButton\",\n    type: \"submit\",\n    value: \"Se connecter\"\n  })), __jsx(\"div\", {\n    className: \"FormFooter\"\n  }, __jsx(\"span\", null, \"Pas encore membre ?\"), props.query.location !== undefined && __jsx(Link, {\n    href: `SignUp?location=${location}`\n  }, __jsx(\"a\", null, \"Inscrivez-vous\")), props.query.location === undefined && __jsx(Link, {\n    href: \"SignUp\"\n  }, __jsx(\"a\", null, \"Inscrivez-vous\")))));\n};\n\nexport default FormComponent;","map":null,"metadata":{},"sourceType":"module"}