{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport Modal from 'antd/lib/modal/Modal';\nimport { Button, message } from 'antd';\nimport Axios from 'axios';\nimport { useState, useEffect } from 'react';\nimport moment from 'moment';\n\nvar NotifCard = function NotifCard(_ref) {\n  var profile = _ref.profile,\n      notif = _ref.notif,\n      all = _ref.all;\n\n  var _useState = useState(notif.Message.length < 150),\n      isFull = _useState[0],\n      setFulltext = _useState[1];\n\n  var _useState2 = useState(),\n      Data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState(true),\n      Loading = _useState3[0],\n      setLoading = _useState3[1];\n\n  var isSameDate = moment(notif.day).isSame(Date.now(), 'day');\n\n  var _useState4 = useState(\"\"),\n      action = _useState4[0],\n      setAction = _useState4[1];\n\n  var _useState5 = useState(false),\n      buttonLoading = _useState5[0],\n      setbuttonLoad = _useState5[1];\n\n  var _useState6 = useState(false),\n      visible = _useState6[0],\n      setvisible = _useState6[1]; // Handle data before loading componenent\n\n\n  moment.locale('fr');\n  useEffect(function () {\n    Axios.get(\"/api/profiles/profile?userid=\" + notif.SenderId, {\n      withCredentials: true\n    }).then(function (result) {\n      setData(result.data.profile);\n      setLoading(false);\n    })[\"catch\"](function (err) {\n      return console.log(err);\n    });\n    Axios.get(\"/api/profiles/viewedNot\", {\n      withCredentials: true\n    }).then(function (result) {})[\"catch\"](function (err) {\n      return console.log(err);\n    });\n  }, []); // ----------------------------\n  // When accept the request handler \n\n  var HandleAccept = function HandleAccept() {\n    setbuttonLoad(true);\n    action === \"accepted\" ? notif.AcceptStatus = true : '';\n    action === \"refused\" || action === \"canceled\" ? notif.AcceptStatus = false : '';\n    notif.AcceptStatus === false ? all.splice(all.indexOf(notif)) : '';\n    notif.AcceptStatus === false ? profile.booked[notif.day].splice(profile.booked[notif.day].indexOf(notif.horraire), 1) : '';\n    var body = {\n      Notification: all,\n      booked: profile.booked\n    };\n    Axios.post(\"/api/profiles/updatebook\", body, {\n      withCredentials: true\n    }).then(function (result) {})[\"catch\"](function (err) {\n      return console.log(err);\n    });\n    var Data = {\n      Notification: {\n        Type: \"Response\",\n        Message: \"Request \" + action,\n        horraire: notif.horraire,\n        day: notif.day,\n        AcceptStatus: action === \"accepted\" ? true : false\n      }\n    };\n    Axios.post(\"/api/profiles/bookmeeting?userid=\" + notif.SenderId, Data, {\n      withCredentials: true\n    }).then(function (result) {\n      setbuttonLoad(false);\n      setvisible(false);\n      message.success(\"mise à jour effectuée avec succès\");\n    })[\"catch\"](function (err) {\n      return console.log(err);\n    });\n  };\n\n  if (Loading) {\n    return null;\n  } else {\n    var date = new Date();\n    return __jsx(React.Fragment, null, notif.Type === \"Request\" && __jsx(\"div\", {\n      className: \"NotifCard\"\n    }, __jsx(\"p\", null, __jsx(\"strong\", {\n      style: {\n        color: \"#0C72BF\"\n      }\n    }, \"Ce client\"), \" \", \"souhaite r\\xE9server une r\\xE9union Le\", \" \", __jsx(\"strong\", {\n      style: {\n        color: \"#0C72BF\"\n      }\n    }, notif.day, \" \"), \"a\", \" \", __jsx(\"strong\", {\n      style: {\n        color: \"#0C72BF\"\n      }\n    }, notif.horraire)), __jsx(\"div\", {\n      className: \"Card_Head\"\n    }, __jsx(\"div\", {\n      className: \"ProfileImg\"\n    }, __jsx(\"img\", {\n      src: Data.Usrimg\n    })), __jsx(\"div\", {\n      className: \"ProfileInfo\"\n    }, __jsx(\"a\", {\n      href: \"/Profiles/\" + notif.SenderId,\n      className: \"profileLink\"\n    }, __jsx(\"h3\", null, Data.companyname === undefined || Data.companyname === \"\" ? Data.nom + \" \" + Data.prenom : Data.companyname)))), __jsx(\"div\", {\n      className: \"Card_Body\"\n    }, __jsx(\"h3\", null, \"Message\"), __jsx(\"p\", null, !isFull ? notif.Message.substr(0, 150) : notif.Message, !isFull ? __jsx(\"span\", {\n      className: \"more\",\n      onClick: function onClick() {\n        return setFulltext(true);\n      }\n    }, \"Voir plus\") : \"\")), __jsx(\"div\", {\n      className: \"Card_footer\"\n    }, notif.AcceptStatus === null && __jsx(React.Fragment, null, __jsx(\"button\", {\n      className: \"Accepter\",\n      onClick: function onClick() {\n        setvisible(true), setAction('accepted');\n      }\n    }, \"Accepter\"), __jsx(\"button\", {\n      className: \"Refuser\",\n      onClick: function onClick() {\n        setvisible(true), setAction('refused');\n      }\n    }, \"Refuser\")), notif.AcceptStatus === true && __jsx(\"div\", null, __jsx(\"label\", {\n      style: {\n        color: \"#02C39A\"\n      }\n    }, __jsx(\"i\", {\n      style: {\n        marginRight: '5px'\n      },\n      className: \"fa fa-check\",\n      \"aria-hidden\": \"true\"\n    }), \"Accept\\xE9\")), notif.AcceptStatus === false && __jsx(React.Fragment, null, __jsx(\"label\", {\n      style: {\n        color: \"#CF0004\"\n      }\n    }, __jsx(\"i\", {\n      className: \"fa fa-times\",\n      \"aria-hidden\": \"true\",\n      style: {\n        marginRight: '5px'\n      }\n    }), \"Refus\\xE9\"))), __jsx(\"div\", {\n      style: {\n        marginTop: '20px',\n        display: 'flex',\n        flexDirection: \"column\"\n      }\n    }, __jsx(\"span\", {\n      style: {\n        fontFamily: 'GlacialRegular',\n        color: '#006d77',\n        padding: '8px 15px'\n      }\n    }, moment(notif.date).fromNow()), !isSameDate && notif.AcceptStatus === true && __jsx(React.Fragment, null, __jsx(\"label\", {\n      className: \"cancel\",\n      onClick: function onClick() {\n        setvisible(true), setAction('canceled');\n      }\n    }, \"Annuler la r\\xE9union\"))), __jsx(Modal, {\n      visible: visible,\n      width: \"20vw\",\n      onCancel: function onCancel() {\n        return setvisible(false);\n      },\n      footer: [__jsx(Button, {\n        disabled: false,\n        key: \"submit\",\n        type: \"primary\",\n        loading: buttonLoading,\n        style: {\n          borderRadius: \"10px\",\n          fontFamily: \"GlacialBold\"\n        },\n        onClick: HandleAccept\n      }, \"Je suis s\\xFBr !\")]\n    }, __jsx(\"h3\", null, \"\\xCAtes-vous s\\xFBr de vouloir \", action === \"accepted\" ? \"accepter\" : \"refuser\", \" cette demande?\"))), notif.Type === \"Response\" && notif.AcceptStatus && __jsx(\"div\", {\n      className: \"NotifCard\"\n    }, __jsx(\"div\", {\n      className: \"Card_Head\"\n    }, __jsx(\"div\", {\n      className: \"ProfileImg\"\n    }, __jsx(\"img\", {\n      src: Data.Usrimg\n    }))), __jsx(\"p\", {\n      style: {\n        color: \"#02C39A\"\n      }\n    }, __jsx(\"strong\", {\n      style: {\n        fontFamily: \"GlacialBold\"\n      }\n    }, __jsx(\"a\", {\n      href: \"/Profiles/\" + notif.SenderId,\n      className: \"profileLink\",\n      style: {\n        color: \"#02C39A\"\n      }\n    }, Data.companyname)), \" \", \"a accept\\xE9 votre demande\", \" \"), __jsx(\"div\", {\n      className: \"Card_Body\"\n    }, __jsx(\"p\", {\n      style: {\n        color: \"#2a2a2a\",\n        fontSize: \"15px\"\n      }\n    }, \"Votre rendez-vous est pr\\xE9vue\", \" \", __jsx(\"strong\", {\n      style: {\n        fontFamily: \"GlacialBold\"\n      }\n    }, notif.day), \" \", \"a\", \" \", __jsx(\"strong\", {\n      style: {\n        fontFamily: \"GlacialBold\"\n      }\n    }, notif.horraire))), __jsx(\"span\", {\n      style: {\n        fontFamily: 'GlacialRegular',\n        color: '#006d77'\n      }\n    }, moment(notif.date).fromNow())), notif.Type === \"Response\" && !notif.AcceptStatus && __jsx(\"div\", {\n      className: \"NotifCard\"\n    }, __jsx(\"div\", {\n      className: \"Card_Head\"\n    }, __jsx(\"div\", {\n      className: \"ProfileImg\"\n    }, __jsx(\"img\", {\n      src: Data.Usrimg\n    }))), __jsx(\"p\", {\n      style: {\n        color: \"#CF0004\"\n      }\n    }, __jsx(\"strong\", {\n      style: {\n        fontFamily: \"GlacialBold\"\n      }\n    }, __jsx(\"a\", {\n      href: \"/Profiles/\" + notif.SenderId,\n      className: \"profileLink\",\n      style: {\n        color: \"#CF0004\"\n      }\n    }, Data.companyname)), \" \", notif.Message === \"Request canceled\" ? \"a annulé la réunion \" : \"a refusé votre demande \"), __jsx(\"div\", {\n      className: \"Card_Body\"\n    }, __jsx(\"p\", {\n      style: {\n        color: \"#2a2a2a\",\n        fontSize: \"15px\"\n      }\n    }, \"Cette entreprise ne peut pas vous rencontrer Le\", \" \", __jsx(\"strong\", {\n      style: {\n        fontFamily: \"GlacialBold\"\n      }\n    }, notif.day), \" \", \"a\", \" \", __jsx(\"strong\", {\n      style: {\n        fontFamily: \"GlacialBold\"\n      }\n    }, notif.horraire), \" essayez une autre date .\")), __jsx(\"span\", {\n      style: {\n        fontFamily: 'GlacialRegular',\n        color: '#006d77'\n      }\n    }, moment(notif.date).fromNow())));\n  }\n};\n\nexport default NotifCard;","map":null,"metadata":{},"sourceType":"module"}