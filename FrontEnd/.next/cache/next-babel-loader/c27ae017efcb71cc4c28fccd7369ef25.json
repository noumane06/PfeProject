{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport Link from 'next/link';\nimport axios from 'axios';\nimport { useEffect, useState } from 'react';\nimport { message } from 'antd';\n\nvar FormComponent = function FormComponent(props) {\n  var data = {\n    // type must be either 'Société' or 'Client' , if you chnage the values be sure to change it in backend too\n    email: \"\",\n    password: \"\"\n  };\n\n  var _useState = useState(data),\n      userData = _useState[0],\n      setData = _useState[1];\n\n  var _useState2 = useState(false),\n      emailErr = _useState2[0],\n      setErrEm = _useState2[1];\n\n  var _useState3 = useState(false),\n      passwordErr = _useState3[0],\n      setErrPass = _useState3[1];\n\n  var _useState4 = useState(\"/\"),\n      location = _useState4[0],\n      setLocation = _useState4[1];\n\n  var _useState5 = useState(false),\n      Loggedin = _useState5[0],\n      setLog = _useState5[1];\n\n  useEffect(function () {\n    if (props.query.ref !== undefined) {\n      if (props.query.ref === \"tokenexpired\") {\n        message.warning('veuillez d abord vous connecter');\n      }\n    }\n\n    if (props.query.location !== undefined) {\n      setLocation(props.query.location);\n    }\n\n    axios.get('http://15.237.56.214:9000/profiles/myprofile', {\n      withCredentials: true\n    }).then(function (res) {\n      setLog(true);\n      setTimeout(function () {\n        window.location.replace(\"/\");\n      }, 5000);\n    })[\"catch\"](function (err) {});\n  }, []);\n\n  var handleSubmit = function handleSubmit(e) {\n    e.preventDefault();\n    axios.post(\"http://15.237.56.214:9000/signin/\", userData, {\n      withCredentials: true\n    }).then(function (response) {\n      if (response.status === 200) {\n        window.location.replace(location);\n      } else {\n        setErrEm(true);\n        setErrPass(true);\n      }\n    })[\"catch\"](function (err) {\n      console.log(err);\n      setErrEm(true);\n      setErrPass(true);\n    });\n  };\n\n  var handleChange = function handleChange(event) {\n    var name = event.target.name;\n    var value = event.target.value;\n    setData(_objectSpread(_objectSpread({}, userData), {}, _defineProperty({}, name, value)));\n\n    if (name === \"email\") {\n      setErrEm(false);\n    }\n\n    if (name === \"password\") {\n      setErrPass(false);\n    }\n  };\n\n  return __jsx(\"div\", {\n    className: \"FormContainer\"\n  }, Loggedin && __jsx(\"div\", {\n    className: \"part 1\"\n  }, __jsx(\"h2\", null, \"Nous saluons le retour!\"), __jsx(\"p\", null, \"Vous \\xEAtes d\\xE9j\\xE0 connect\\xE9 et serez bient\\xF4t redirig\\xE9 vers page d'accueil.\"), __jsx(\"div\", {\n    className: \"FormFooter\"\n  }, \"Si vous n'\\xEAtes pas redirig\\xE9 automatiquement suivez\", __jsx(Link, {\n    href: \"/\"\n  }, __jsx(\"a\", null, \"ce lien\")))), !Loggedin && __jsx(React.Fragment, null, __jsx(\"h1\", null, \"Connectez-vous\"), __jsx(\"form\", {\n    onSubmit: handleSubmit\n  }, __jsx(\"label\", null, \"Email\"), __jsx(\"br\", null), __jsx(\"input\", {\n    className: emailErr ? \"input error\" : \"input\",\n    style: {\n      width: '80%'\n    },\n    type: \"email\",\n    name: \"email\",\n    onChange: handleChange,\n    value: userData.email,\n    required: true\n  }), __jsx(\"br\", null), __jsx(\"label\", {\n    className: emailErr ? \"errMsg\" : \"hidden\"\n  }, \"email invalide\"), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(\"label\", null, \"Mode de passe\"), __jsx(\"br\", null), __jsx(\"input\", {\n    className: passwordErr ? \"input error\" : \"input\",\n    style: {\n      width: '80%'\n    },\n    type: \"password\",\n    name: \"password\",\n    onChange: handleChange,\n    value: userData.password,\n    required: true\n  }), __jsx(\"br\", null), __jsx(\"label\", {\n    className: passwordErr ? \"errMsg\" : \"hidden\"\n  }, \"mot de passe incorrect\"), __jsx(\"br\", null), __jsx(\"br\", null), __jsx(\"input\", {\n    className: \"SignButton\",\n    type: \"submit\",\n    value: \"Se connecter\"\n  })), __jsx(\"div\", {\n    className: \"FormFooter\"\n  }, __jsx(\"span\", null, \"Pas encore membre ?\"), props.query.location !== undefined && __jsx(Link, {\n    href: \"SignUp?location=\".concat(location)\n  }, __jsx(\"a\", null, \"Inscrivez-vous\")), props.query.location === undefined && __jsx(Link, {\n    href: \"SignUp\"\n  }, __jsx(\"a\", null, \"Inscrivez-vous\")))));\n};\n\nexport default FormComponent;","map":null,"metadata":{},"sourceType":"module"}